classmanagerimplextends manager implextends bshclassmanager bsh manager manage all classloading in beanshell bean shell allows classpath extension and reloading this holds the of the bshclassmanager bsh manager so that it can be separated from the core this currently relies on 1 2 for bshclassloader bsh loader and weak references is there a workaround for weak refs? if so we could make this work with 1 1 by supplying our own classloader see http www beanshell org/manual/classloading html for details on the bsh classloader architecture bsh has a multi tiered loading architecture no loader is created unless/until a is generated the classpath is modified or a is reloaded note we may need some synchronization in here note on jdk1 2 dependency we are forced to use weak references here to accomodate all of the fleeting namespace listeners namespaces name spaces must be informed if the space changes so that they can un cache names i had the interesting thought that a way around this would be to implement beanshell's bean shell's own garbage collector then i came to my senses and said screw it re loading will require 1 2 classloading precedence in script evaluated scripted in script added / modified classpath optionally external classloader optionally thread context classloader plain forname for name source in classpath classmanagerimpl manager impl classforname for name name net url u r l getresource get resource path io inputstream input stream getresourceasstream get resource as stream path addclasspath add path net url u r l path io ioexception i o reset setclasspath set path net url u r l cp reloadallclasses reload all classes classpathexception path reloadclasses reload classes classnames names classpathexception path reloadpackage reload pack classpathexception path bshclasspath bsh path getclasspath get path classpathexception path dosuperimport do super utilevalerror eval hassuperimport has super getclassnamebyunqname get name by unq name name classpathexception path addlistener add listener bshclassmanager bsh manager listener l removelistener remove listener bshclassmanager bsh manager listener l classloader loader getbaseloader get base loader defineclass define name byte classloaderchanged loader changed dump io printwriter print writer i classforname for name in bshclassmanager bsh manager the or getresource get resource in bshclassmanager bsh manager path should be an absolute path getresourceasstream get resource as stream in bshclassmanager bsh manager path should be an absolute path addclasspath add path in bshclassmanager bsh manager io ioexception i o reset in bshclassmanager bsh manager setclasspath set path in bshclassmanager bsh manager reloadallclasses reload all classes in bshclassmanager bsh manager classpathexception path reloadclasses reload classes in bshclassmanager bsh manager classpathexception path reloadpackage reload in bshclassmanager bsh manager classpathexception path classpathexception path dosuperimport do super in bshclassmanager bsh manager utilevalerror eval hassuperimport has super in bshclassmanager bsh manager getclassnamebyunqname get name by unq name in bshclassmanager bsh manager classpathexception path addlistener add listener in bshclassmanager bsh manager removelistener remove listener in bshclassmanager bsh manager defineclass define in bshclassmanager bsh manager classloaderchanged loader changed in bshclassmanager bsh manager dump in bshclassmanager bsh manager 