build index offsets and populate instance weights @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override @override @ override 