assumes that there are as many records as documents indexed by docs assumes that extractor at most one value 