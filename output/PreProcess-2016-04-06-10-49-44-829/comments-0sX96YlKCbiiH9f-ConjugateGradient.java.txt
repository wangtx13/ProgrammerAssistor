conjugate gradient polak and ribiere from numeric recipes in c section 10 6 eps is a small number to recitify the special case of converging to exactly zero function value alternative this linemaximizer line maximizer = new gradientbracketlineoptimizer gradient bracket line optimizer function the state of a conjugate gradient search this termination provided by numeric recipes in c this termination provided by mccallum mc callum gdruck mallet line search algorithms stop search whenever a step is found that increases the value significantly conjugategradient conjugate gradient assumes that line maximization finds something close to the maximum in that direction in tests sometimes the direction suggested by cg c g was downhill consequently here i am setting the search direction to the gradient if the slope is negative or 0 