never instantiated chopped point try for points along edge /* if isclosed is closed size > 1 { node first = get 0 node last = get size 1 point2d point2 d chop = geom intersect first x 0 first y 0 last x 0 last y 0 p x p y ctr x ctr y if chop != { cl = geom length2 chop x chop y p x p y if cl < len { len = cl cx = chop x cy = chop y } } }*/ if none found pick closest vertex from doug lea's polygonfigure polygon figure line 1 point 1 x line 1 point 1 y line 1 point 2 x line 1 point 2 y line 2 point 1 x line 2 point 1 y line 2 point 2 x line 2 point 2 y source http vision dai ed ac uk/andrewfg/c g a faq html eq for lines ab a b and cd c d ya y a yc y c xd x d xc x c xa x a xc x c yd y d yc y c r = eqn 1 xb x b xa x a yd y d yc y c yb y b ya y a xd x d xc x c ya y a yc y c xb x b xa x a xa x a xc x c yb y b ya y a s = eqn 2 xb x b xa x a yd y d yc y c yb y b ya y a xd x d xc x c xi x i = xa x a + r xb x b xa x a yi y i = ya y a + r yb y b ya y a parallel coincident pick one end of first line from doug lea's polygonfigure polygon figure line 1 point 1 x line 1 point 1 y line 1 point 2 x line 1 point 2 y line 2 point 1 x line 2 point 1 y line 2 point 2 x line 2 point 2 y source http vision dai ed ac uk/andrewfg/c g a faq html eq for lines ab a b and cd c d ya y a yc y c xd x d xc x c xa x a xc x c yd y d yc y c r = eqn 1 xb x b xa x a yd y d yc y c yb y b ya y a xd x d xc x c ya y a yc y c xb x b xa x a xa x a xc x c yb y b ya y a s = eqn 2 xb x b xa x a yd y d yc y c yb y b ya y a xd x d xc x c xi x i = xa x a + r xb x b xa x a yi y i = ya y a + r yb y b ya y a parallel coincident pick one end of first line line 1 point 1 x line 1 point 1 y line 1 point 2 x line 1 point 2 y line 2 point 1 x line 2 point 1 y line 2 point 2 x line 2 point 2 y source http vision dai ed ac uk/andrewfg/c g a faq html eq for lines ab a b and cd c d ya y a yc y c xd x d xc x c xa x a xc x c yd y d yc y c r = eqn 1 xb x b xa x a yd y d yc y c yb y b ya y a xd x d xc x c ya y a yc y c xb x b xa x a xa x a xc x c yb y b ya y a s = eqn 2 xb x b xa x a yd y d yc y c yb y b ya y a xd x d xc x c xi x i = xa x a + r xb x b xa x a yi y i = ya y a + r yb y b ya y a parallel coincident pick one end of first line from doug lea's polygonfigure polygon figure source http vision dai ed ac uk/andrewfg/c g a faq html#q7 let the point be c xc x c yc y c and the line be ab a b xa x a ya y a to xb x b yb y b the length of the line segment ab a b is l ___________________ | 2 2 l = \| xb x b xa x a + yb y b ya y a and ya y a yc y c ya y a yb y b xa x a xc x c xb x b xa x a r = l**2 ya y a yc y c xb x b xa x a xa x a xc x c yb y b ya y a s = l**2 let i be the point of perpendicular projection of c onto ab a b the xi=xa+r x i= x a+r xb x b xa x a yi=ya+r y i= y a+r yb y b ya y a distance from a to i = r*l r* l distance from c to i = s*l s* l if r < 0 i is on backward extension of ab a b if r>1 i is on ahead extension of ab a b if 0<=r<=1 i is on ab a b if s < 0 c is left of ab a b you can just check the numerator if s>0 c is right of ab a b if s=0 c is on ab a b /* for directional instead use snum = ya yc * xb xa xa xc * yb ya s = snum / l2 l = math sqrt l2 = s * l */ 